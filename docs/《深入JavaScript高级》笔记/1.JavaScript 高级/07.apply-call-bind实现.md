---
title: apply-call-bind实现
date: 2022-12-26 21:09:49
permalink: /pages/6cf13b/
categories:
  - 《深入JavaScript高级》笔记
tags:
  -
author:
  name: Q7Long
  link: https://github.com/Q7Long
---

# 07apply-call-bind 实现

## JS 函数式编程

### 实现 apply、call、bind

![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image1.png)

内部实现是 C++ 这里使用 JS 模拟实现 不会过渡考虑一些边界情况

### call 函数的实现

![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image2.png)
![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image3.png)

#### 仅仅通过 Function.prototype.hycall 绑定方法与 call 方法的区别

![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image4.png)
![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image5.png)

#### 怎么执行调用的那个函数

![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image6.png)
![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image7.png)

#### 创建方法传参时候的问题

![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image8.png)
![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image9.png)
![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image10.png)

#### 怎么接受到传入的参数，然后将参数变成函数调用者的 this

##### 第一种办法 通过 call 绑定 this

![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image11.png)

##### 第二种办法

![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image12.png)
![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image13.png)

**但是这里就有一个问题了，如果传入的是非对象类型 比如是数字类型就没有办法绑定函数了 数字类型上面没办法加东西 所以数字类型没有办法加函数** **所以需要把其他类型转换成对象类型**

##### object()将其他类型转换成对象类型

###### 系统在传入数字类型的时候，会变成 Number 类型，123 => new Number(num);

![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image14.png)
![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image15.png)

###### 如何解决

![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image16.png)
![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image17.png)
![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image18.png)

###### 所以提前对参数进行转化，防止传入的是非对象类型

![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image19.png)
![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image20.png)

##### 系统 call 里面如果传入的是 null 或者 undefined 的时候，this 会默认绑定到 window

![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image21.png)
![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image22.png)

###### 而我们创建的 hycall 如果在传入 undefined null 的时候，Object(null) Object(undefined) 会返回 空对象

![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image23.png)
![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image24.png)
![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image25.png)

![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image27.png)

##### 关于自定义 call 传入多个参数的问题

![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image28.png)

###### 使用 Es6 剩余参数 rest parometers 传入参数

![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image29.png)

![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image30.png)

![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image31.png)
![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image32.png)
![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image33.png)

###### 当我们需要一个 sum 计算的结果的时候，目前来说函数是没有返回值的 ，所以即使打印结果也是 undefined，所以需要有一个返回值来接收结果

#### 实现 call 的完整代码

![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image34.png)
![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image35.png)
![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image36.png)

### apply 函数的实现

#### 特殊情况 qlapply 方法里面没有传入第二个参数 argArray 那么默认就是 undefined

![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image37.png)

##### 这里就会报错一个 argArray 是 undefined 是不能迭代的

![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image38.png)

##### 如何解决？

可以做一个判断

![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image39.png)

#### 全部的 apply 代码

![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image40.png)

#### 为什么 call 里面没有出现 undefined 的情况

![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image41.png)

#### 注意，如果只有一个参数的时候也必须要带[ ] foo.qlapply('aaa',[20])

### **⭐⭐ 实现 bind 函数 面试题**

#### bind 的使用

![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image42.png)

**_实现 bind 的全部代码_**

![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image43.png)

### arguments

#### arguments 的基本使用

![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image44.png)

#### 手写 slice

![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image45.png)

#### **⭐⭐**arguments 的进阶使用

#### **⭐**将 arguments 转化成数组 slice 函数 (不太好理解)

![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image46.png)

#### ES6 新语法将 arguments 转化成数组

![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image47.png)

![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image48.png)

#### 展开运算符将 arguments 转化成数组

![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image49.png)

### arguments 用于什么地方

#### 比如函数里面参数是两个参数，但是后续可能需要传入的其他参数的时候，可以用 arguments

![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image50.png)

#### 但是一般不使用 arguments 推荐使用剩余参数

### Array 注意点：

#### 直接使用 Array(123)不是创建 [1,2,3]的数组，Array()里面传入的参数是数组长度

![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image51.png)

### 箭头函数里面没有 arguments

#### **⭐**在箭头函数里面打印 arguments 的两种情况

**在箭头函数里面是没有 arguments 的，但是如果非要打印 arguments，则分情况，如果是在浏览器中则会报错 arguments is not defined**

**但是在 node 里面，可以打印出来，主要就是因为 node 在执行 JavaScript 代码的时候，会去执行 call({javascript 代码},ads,sdsd,sds)**

**JavaScript 代码会被放进 call 函数的第一个对象里面，而 node 里面的 arguments 则会把 call 函数里面的，除了对象之外的东西放入到全局的 arguments 里面，所以在 node 环境下，打印箭头函数里面的 arguments 不会报错，而是会打印一些其他东西的原因**

##### node 环境下

![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image52.png)

![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image53.png)

#### 浏览器(箭头函数和非箭头函数)打印 arguments 的两种情况

![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image54.png)

#### node (箭头函数和非箭头函数)打印 arguments 的两种情况

![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image55.png)

#### 箭头函数里面匹配参数的方法 剩余参数 ...args

![img](http://www.zhangqilong.cn/img/qlBlog_images/%E6%B7%B1%E5%85%A5JavaScript%E9%AB%98%E7%BA%A7/07.apply-call-bind%E5%AE%9E%E7%8E%B0/image56.png)
