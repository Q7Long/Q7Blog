---
title: Vuexçš„äº”å¤§æ ¸å¿ƒ
date: 2022-01-12 19:52:28
permalink: /pages/65d695/
categories:
  - ã€ŠVueã€‹ç¬”è®°
  - Vuex
tags:
  -
author:
  name: ZhangQiLong
  link: https://github.com/ZhangQiLong2023
---

# ğŸ’vuex ä¸­æœ‰äº”å¤§æ ¸å¿ƒ stateã€gettersã€mutationsã€actionsã€modules - made by ZhangQiLong

## ğŸŠVuex ç¬¬ä¸€å¤§æ ¸å¿ƒ State

![image-20230111103929484](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111103929484.png)

### ğŸ‰Vuex-state å±•ç¤ºçš„è¾…åŠ©å‡½æ•° mapState åœ¨ Computed è®¡ç®—å±æ€§ä¸­ä½¿ç”¨

![image-20230111104240843](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111104240843.png)

1. å¦‚æœæˆ‘ä»¬æƒ³è¦åœ¨ç»„ä»¶ä¸­ä½¿ç”¨åˆ° store ä¸­æ•°æ®çš„æ—¶å€™ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨ $store.state.counter æ¥è·å–å­˜å‚¨åœ¨ store ä¸­çš„ counter æ•°æ®ï¼Œä½†æ˜¯å¦‚æœåœ¨å¾ˆå¤šåœ°æ–¹éƒ½éœ€è¦ä½¿ç”¨åˆ°çš„æ—¶å€™ï¼Œé‚£ä¹ˆå†™èµ·æ¥å°±ä¼šéå¸¸çš„ç¹çï¼Œé‚£ä¹ˆèƒ½ä¸èƒ½è¿›è¡Œç®€åŒ–å‘¢ï¼Ÿ

2. å¦‚æœæˆ‘ä»¬åœ¨ {{}} æ¨¡æ¿ä¸­ä½¿ç”¨åˆ°æ•°æ®çš„æ—¶å€™ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æŠŠå¯¹åº”çš„æ“ä½œæŠ½å–åˆ°è®¡ç®—å±æ€§ä¸­

3. æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ vuex æä¾›çš„ mapState(æ˜¯ä¸€ä¸ªå‡½æ•°)ï¼ŒmapState å‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°† mapState è¿”å›çš„å¯¹è±¡ï¼Œè§£æ„ä¹‹åæ”¾å…¥åˆ° computed å¯¹è±¡ä¸­

![image-20230111110016793](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111110016793.png)

4. è¿™æ ·å†™æˆ‘ä»¬å°±æœ‰äº† counter name age height å¯¹åº”çš„è®¡ç®—å±æ€§ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬æ•°ç»„çš„ä¸€ç§å†™æ³•

5. é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¯¹è±¡çš„å½¢å¼ï¼Œå¯¹è±¡å½¢å¼çš„è¯å¯ä»¥ç»™è®¡ç®—å±æ€§èµ·åˆ«å

6. å¯¹è±¡é‡Œé¢æ˜¯é”®å€¼å¯¹çš„å½¢å¼ sCounter å¯¹è±¡çš„å€¼æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå½“æˆ‘ä»¬éœ€è¦è·å– sCounter çš„æ—¶å€™ï¼Œé‚£ä¹ˆå°±ä¼šå»å›è°ƒè¿™ä¸ªå‡½æ•°ï¼Œå¹¶ä¸”è¿™æ—¶å€™ä¼šä¼ è¿‡æ¥ä¸€ä¸ªå‚æ•° state,å½“æˆ‘ä»¬æ‹¿åˆ° state çš„æ—¶å€™ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä» state ä¸­è·å–åˆ°éœ€è¦çš„æ•°æ®

![image-20230111110517243](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111110517243.png)

![image-20230111105142300](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111105142300.png)

### ğŸ‰Vuex-state å±•ç¤ºçš„è¾…åŠ©å‡½æ•° mapState åœ¨ setup ä¸­ä½¿ç”¨

![image-20230111152309604](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111152309604.png)

1. æˆ‘ä»¬åˆšæ‰ä½¿ç”¨ mapState æ˜¯åœ¨ computed ä¸­ä½¿ç”¨ï¼Œè€Œ mapState æ˜¯å±äºçš„ opctions api

2. ä½†æ˜¯åœ¨æœ€æ–°çš„ Vue3 æˆ‘ä»¬å¸Œæœ›åœ¨ setup ä¸­ä½¿ç”¨çš„ï¼Œæˆ‘ä»¬æƒ³è¦å°† counter name age ç­‰æ•°æ®è½¬åŒ–æˆè®¡ç®—å±æ€§

![image-20230111111343124](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111111343124.png)

### ğŸ‰ ä½¿ç”¨ Vuex æä¾›çš„ hook useStore æ¥è·å–åˆ° store

3. è¿™é‡Œçš„ useStore å’Œ useRouter æ˜¯ç±»ä¼¼çš„ï¼ŒuseStore å¯ä»¥è·å–åˆ°æœ€å¤§çš„ store

![image-20230111111845372](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111111845372.png)

4. ä½†æ˜¯å¦‚æœè¿™é‡Œæœ‰å¾ˆå¤šçš„è®¡ç®—å±æ€§ï¼Œé‚£ä¹ˆå†™èµ·æ¥å°±ä¼šç‰¹åˆ«çš„ç¹ç

![image-20230111112425526](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111112425526.png)

5. æˆ‘ä»¬å¯ä¸å¯ä»¥ä½¿ç”¨ mapState è¿›è¡Œæ˜ å°„å‘¢ï¼Ÿä¸å¯ä»¥ï¼è¿™æ ·æ¸²æŸ“å‡ºæ¥çš„ç»“æœä¼šæœ‰é—®é¢˜

![image-20230111112803331](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111112803331.png)

6. é¡µé¢çš„å±•ç¤ºæ•ˆæœå¦‚ä¸‹

![image-20230111113123782](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111113123782.png)

![image-20230111153043830](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111153043830.png)

7. ä¸ºä»€ä¹ˆè¿™é‡Œæ˜¾ç¤ºçš„æ˜¯å‡½æ•°å‘¢ï¼Ÿ

   æ—¢ç„¶æˆ‘ä»¬ä¹‹å‰å¯ä»¥å°† mapState æ”¾å…¥åˆ° computed ä¸­ï¼Œè€Œ computed é‡Œé¢åº”è¯¥æ”¾å…¥çš„æ˜¯å‡½æ•°å½¢å¼çš„ï¼Œæ¯”å¦‚æˆ‘ä»¬é‡Œé¢æ”¾çš„éƒ½æ˜¯ fullName()ï¼ŒmapState é‡Œé¢å†…å®¹å­˜æ”¾çš„å½¢å¼æ˜¯

```js
{
  counter:function(){},
  name:function(){},
  age:function(){},
  height:function(){}
}
```

![image-20230111113458516](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111113458516.png)

8. æ‰€ä»¥æˆ‘ä»¬åœ¨ç•Œé¢ä¸­çœ‹åˆ°æ˜¾ç¤ºå‡ºæ¥çš„éƒ½æ˜¯å‡½æ•°å½¢å¼çš„å†…å®¹ï¼Œå› ä¸º mapState è¿”å›çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œå¯¹è±¡é‡Œé¢éƒ½æ˜¯ä¸€ä¸ªä¸ªçš„å‡½æ•°

9. é‚£ä¹ˆæˆ‘ä»¬éœ€è¦æ€ä¹ˆåšå‘¢ï¼Ÿ

   æˆ‘ä»¬æ—¢ç„¶æ‹¿åˆ°çš„æ˜¯å‡½æ•°å½¢å¼çš„å†…å®¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªå‡½æ•°æ”¾å…¥åˆ° computed ä¸­è¿›è¡Œä¸€ä¸ªåŒ…è£¹ï¼Œç„¶åè¿™ä¸ªå‡½æ•°çš„è¿”å›å€¼å°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„ counter name age height ç­‰æ•°æ®

![image-20230111115731092](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111115731092.png)

```vue
<template>
  <h2>Home:{{ $store.state.counter }}</h2>
  <h2>computed:{{ sCounter }}</h2>
  <h2>{{ name }}</h2>
  <h2>{{ age }}</h2>
  <h2>{{ height }}</h2>
</template>

<script>
import { mapState, useStore } from "vuex"
import { computed } from "vue"
export default {
  setup() {
    //1. setup()ä¸­ä¸å«æœ‰thisï¼Œè¿™é‡Œä¸å¯ä»¥ä½¿ç”¨this.storeè·å– store
    const store = useStore()
    const sCounter = computed(() => store.state.counter)
    //2. ä½†æ˜¯è¿™é‡Œæˆ‘ä»¬å¦‚æœæœ‰å¾ˆå¤šçš„å±æ€§å‘¢ï¼Œæˆ‘ä»¬å¯ä»¥ä¸å¯ä»¥æŒ‰ç…§åŸæ¥çš„æ–¹æ³•
    const storeStateFns = mapState(["name", "age", "height"])
    //3.æƒ³è¦è¾¾åˆ°æ•ˆæœ counter => function => computed(function) => counter
    // {name:function,age:function(),height:function()}

    // 6. å®šä¹‰ä¸€ä¸ªç©ºçš„å¯¹è±¡ storeState
    const storeState = {}
    //4. å‚æ•°: fnKey: name,age,height
    // fn: æ ¹æ®é‡Œé¢çš„ fnKey å°±å¯ä»¥æ‹¿åˆ°é”®å€¼å¯¹name age heightï¼Œå¯¹åº”çš„å‡½æ•°
    Object.keys(storeStateFns).forEach((fnKey) => {
      //fn: name age heightï¼Œå¯¹åº”çš„å‡½æ•°
      const fn = storeStateFns[fnKey]
      //5. å°†å–åˆ°çš„å‡½æ•°æ”¾å…¥åˆ° computed ä¸­ï¼Œè¿™é‡Œè¿”å›çš„ç»“æœæ˜¯ ref
      // computed(fn)
      //7. å°† ref é‡æ–°æ”¾å…¥åˆ°å¯¹è±¡ä¸­ï¼Œç»“æœå°±æ˜¯ {name:ref,age:ref,height:ref}
      storeState[fnKey] = computed(fn)
    })
    return {
      sCounter,
      // ...storeStateFns,
      //8. æœ€åå°† storeState å¯¹åº”çš„ç»“æœ {name:ref,age:ref,height:ref} ç»“æ„å‡ºå»
      ...storeState,
    }
  },
}
</script>

<style scoped></style>
```

![image-20230111115937593](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111115937593.png)

10. ä½†æ˜¯è¿™é‡Œä¼šæŠ¥é”™ï¼Œæƒ³è¦è¯»å– $store è¯»å–ä¸åˆ°ï¼Œé‚£ä¹ˆæ˜¯åœ¨å“ªé‡Œæƒ³è¦è¯»å– $store å‘¢ï¼Ÿ

![image-20230111121315812](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111121315812.png)

11. å¦‚ä½•è§£å†³ï¼Œé€šè¿‡ vuex æä¾›çš„ hook useStore() æ¥è·å– storeï¼Œç„¶åä½¿ç”¨ bind ç»‘å®š this

![image-20230111121815636](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111121815636.png)

### ğŸ‰ å®Œæ•´ä»£ç å¦‚ä¸‹

```vue
<template>
  <h2>Home:{{ $store.state.counter }}</h2>
  <h2>computed:{{ sCounter }}</h2>
  <h2>{{ name }}</h2>
  <h2>{{ age }}</h2>
  <h2>{{ height }}</h2>
</template>

<script>
import { mapState, useStore } from "vuex"
import { computed } from "vue"
export default {
  setup() {
    //1. setup()ä¸­ä¸å«æœ‰thisï¼Œè¿™é‡Œä¸å¯ä»¥ä½¿ç”¨this.storeè·å– store
    const store = useStore()
    const sCounter = computed(() => store.state.counter)
    //2. ä½†æ˜¯è¿™é‡Œæˆ‘ä»¬å¦‚æœæœ‰å¾ˆå¤šçš„å±æ€§å‘¢ï¼Œæˆ‘ä»¬å¯ä»¥ä¸å¯ä»¥æŒ‰ç…§åŸæ¥çš„æ–¹æ³•
    const storeStateFns = mapState(["counter", "name", "age", "height"])
    // 3. é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ€ä¹ˆåšå‘¢ï¼Ÿ

    /**
     * 3.0 ç¬¬ä¸€ç§æ–¹æ³•å°±æ˜¯é‡å¤ä¸Šé¢å†™çš„(ç¬¨æ–¹æ³•)
     * const counter = computed(() => store.state.counter);
     * const name = computed(() => store.state.name);
     * const age = computed(() => store.state.age);
     * const height = computed(() => store.state.height);
     */
    /**
     * è¿›é˜¶å†™æ³•:
     * 3.1 æ—¢ç„¶computedä¸­éœ€è¦ä¼ å…¥ä¸€ä¸ªå‡½æ•°ï¼Œè§£æ„å‡ºæ¥çš„ ...storeStateä¹Ÿæ˜¯å‡½æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç›´æ¥å°†è§£æ„åçš„æ”¾è¿›computedä¸­
     * 3.2 counter => æ˜¯function => æ”¾è¿›computed åŒ…è£¹computed(function)=>counter
     * 3.3 storeStateæ˜¯ä¸ªå¯¹è±¡ï¼Œæ‹¿åˆ°çš„æ•°æ®åå­—æ˜¯key
     * 3.4 storeState:{name:function,age:function,height:function}
     */
    // 3.6 æˆ‘ä»¬å¯ä»¥é‡æ–°å®šä¹‰ä¸€ä¸ª storeState={}
    const storeState = {}
    Object.keys(storeStateFns).forEach((fnKey) => {
      const fn = storeStateFns[fnKey].bind({ $store: store }) //3.9 è¿™é‡Œæ˜¯æ²¡æœ‰thisçš„ =>undefined.$storeï¼Œé€šè¿‡bindç»‘å®šthis
      //3.5 ç”¨computedå¯¹å‡½æ•°è¿›è¡Œä¸€ä¸ªåŒ…è£¹ï¼Œcomputedè¿”å›çš„æ˜¯ä¸€ä¸ªref
      // computed(fn);
      //3.7 ç„¶åæˆ‘ä»¬å°±å¯ä»¥å°†è¿”å›çš„ refæ”¾å…¥å®šä¹‰çš„storeStateä¸­
      //3.8 é‚£ä¹ˆæˆ‘ä»¬æœ€ç»ˆçš„storeStateå­˜å‚¨çš„ç»“æ„å°±æ˜¯ {name:ref,age:ref,height:ref}
      storeState[fnKey] = computed(fn)
      // å…¶å®å½“æˆ‘ä»¬å†™ ...mapState(["name","age"]) çš„æ—¶å€™å…¶å®ä¹Ÿæ˜¯å†…éƒ¨å¸®åŠ©æˆ‘ä»¬ this.$store.state.name ä½†æ˜¯ä¸Šé¢æ˜¯æ²¡æœ‰thisçš„å°±æ²¡æœ‰äº† this.$store
    })
    return {
      sCounter,
      // counter,
      // name,
      // age,
      // height,
      ...storeState,
    }
  },
}
</script>

<style scoped></style>
```

### ğŸ‰ å°è£…åœ¨ setup ä¸­ä½¿ç”¨çš„ mapState

1. å¦‚æœåœ¨å…¶ä»–åœ°æ–¹éœ€è¦ä½¿ç”¨åˆ°ä¸Šè¿°çš„ä»£ç ï¼Œå¯ä»¥å¯¹å…¶è¿›è¡Œå°è£…ï¼Œé‚£ä¹ˆå½“æˆ‘ä»¬ä½¿ç”¨çš„æ—¶å€™ç›´æ¥è°ƒç”¨å°è£…å¥½çš„ä¸œè¥¿å°±è¡Œ
2. åœ¨ hooks ä¸­è¿›è¡Œå°è£…

![image-20230111151314594](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111151314594.png)

3. åœ¨ç»„ä»¶ä¸­å¯¼å…¥å°è£…å¥½çš„å‡½æ•°æ–¹æ³•ï¼Œéœ€è¦å“ªä¸ªæ•°æ®çš„è¯ï¼Œåªéœ€è¦ä¼ å…¥å¯¹åº”æ•°æ®çš„åå­— mapper å³å¯

![image-20230111151646350](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111151646350.png)

## ğŸŠVuex ç¬¬äºŒå¤§æ ¸å¿ƒ getters

æŸäº›å±æ€§æˆ‘ä»¬éœ€è¦ç»è¿‡å˜åŒ–åæ¥ä½¿ç”¨ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥ä½¿ç”¨ getters

1. æ¯”å¦‚æˆ‘ä»¬éœ€è¦è®¡ç®—å›¾ä¹¦çš„æ€»ä»·æ ¼ï¼Œé¦–å…ˆåœ¨ store ä¸­å®šä¹‰ books æ•°æ®

![image-20230111153724194](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111153724194.png)

2. ç¬¬ä¸€ç§æ–¹å¼æˆ‘ä»¬å¯ä»¥åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ computed è®¡ç®—å±æ€§æ¥è®¡ç®—æ€»ä»·æ ¼

![image-20230111153958128](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111153958128.png)

3. è¿™ç§çš„ç¼ºç‚¹ï¼Œå½“æˆ‘ä»¬å…¶ä»–ç»„ä»¶ä¹Ÿéœ€è¦è¿™æ ·çš„æ•°æ®è½¬åŒ–çš„è¯ï¼Œå°±éœ€è¦å°†è¿™æ ·çš„ä»£ç é‡å†™ä¸€æ¬¡ï¼Œå°±ä¼šæœ‰å¤§é‡çš„ä»£ç 

4. æˆ‘ä»¬å¯ä»¥åœ¨ store ä¸­å†™ä¸€ä¸ª gettersï¼Œè¿™é‡Œé¢çš„ getters å°±ç±»ä¼¼äºè®¡ç®—å±æ€§

![image-20230111154806506](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111154806506.png)

5. åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ getters ä¸­å–å‡ºæ¥çš„ totalPrice
6. getters ä¸­æœ‰ä¸¤ä¸ªå‚æ•° state å’Œ gettersï¼Œåœ¨ getters ä¸­ä½¿ç”¨ getters å…¶ä»–çš„å‡½æ•°å°±éœ€è¦ä¼ å…¥ç¬¬äºŒä¸ªå‚æ•° getters

![image-20230111155130474](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111155130474.png)

### ğŸ‰ åœ¨ç»„ä»¶ä¸­å¯¹ getters ä¼ å…¥å‚æ•°

7. ç»„ä»¶ä¸­å¯¹ getters ä¸­çš„å‡½æ•°ä¼ å…¥å‚æ•°

![image-20230111160108528](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111160108528.png)

8. å¦‚æœåœ¨ç»„ä»¶ä¸­å¯¹ getters ä¸­çš„å‡½æ•°ä¼ å…¥å‚æ•°çš„è¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦è¿”å›ä¸€ä¸ªå‡½æ•°ç”¨äºæ¥æ”¶ä¼ å…¥çš„å‚æ•°

```js
// 08_learn_vuex\src\store\index.js
import { createStore } from 'vuex'

export default createStore({
  state () {
    return {
      counter: 0,
      name: "zql",
      age: 18,
      height: 1.8,
      books: [
        { name: "æ·±å…¥Vuejs", price: 200, count: 3 },
        { name: "æ·±å…¥Webpack", price: 240, count: 5 },
        { name: "æ·±å…¥React", price: 130, count: 1 },
        { name: "æ·±å…¥Nodejs", price: 200, count: 2 },
      ],
      discount: 1
    }
  },
  //3. ç±»ä¼¼äºä¹‹å‰ç»„ä»¶ä¸­çš„è®¡ç®—å±æ€§
  getters: {
    // 6. é‚£ä¹ˆè¿™é‡Œå°±éœ€è¦ä¼ å…¥ç¬¬äºŒä¸ªå‚æ•°äº†
    totalPrice (state, getters) {
      let totalPrice = 0;
      for (const book of state.books) {
        totalPrice += book.count * book.price
      }
      //7. è·å–æŠ˜æ‰£çš„æ–¹æ³•
      return totalPrice * getters.currentDiscount
    },
    //5. å¦‚æœè¿™é‡Œè¦æ˜¯æœ‰æ‰“æŠ˜çš„æ–¹æ³•çš„è¯
    currentDiscount (state) {
      return state.discount * 0.9
    },
    //8.è·å–æ•°é‡å¤§äºNçš„ï¼ŒNæ˜¯å‚æ•°ï¼Œè¿™ä¸ªæ–¹æ³•å¤§äºnçš„æ—¶å€™æ‰ä¼šå¯¹ä»·æ ¼è¿›è¡Œä¸€ä¸ªè®¡ç®—
    // å› ä¸ºè¿™é‡Œè¿˜æ˜¯åœ¨ getters é‡Œé¢çš„å‡½æ•°ï¼Œæ‰€ä»¥è¿™é‡Œçš„å‚æ•°è¿˜æ˜¯ state å’Œ getters
    // å¦‚æœæˆ‘ä»¬è‡ªå·±ä¼ å…¥å‚æ•°çš„è¯ï¼Œé‚£ä¹ˆè¿™é‡Œå°±éœ€è¦è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œå‚æ•°ä¼ å…¥å…¶ä¸­
    totalPriceCounterGreaterN (state, getters) {
      let totalPriceCounter = 0;
      // è¿”å›ä¸€ä¸ªå‡½æ•°æ¥æ”¶ä¼ å…¥çš„å‚æ•°
      return function (n) {
        for (const book of state.books) {
          // 9. å¦‚æœä¼ å…¥çš„å¤§äºnæ‰ä¼šè¿›è¡Œè®¡ç®—ä»·æ ¼
          if (book.count > n) {
            totalPriceCounter += book.count * book.price
          }
        }
        return totalPriceCounter
      }
    },
  mutations: {
    increment (store) {
      store.counter++
    },
    decrement (store) {
      store.counter--
    }
  },
  actions: {
  },
  modules: {
  }
})
```

### ğŸ‰ å½“ getters ä¸­å‡½æ•°å¤šçš„æ—¶å€™

9. åœ¨ store ä¸­ getters ä¸­æœ‰å…¶ä»–çš„å‡½æ•°æ—¶å€™ï¼Œæ·»åŠ  nameInfo ageInfo heightInfo ä¸‰ä¸ª getters

```js
// 08_learn_vuex\src\store\index.js
import { createStore } from "vuex"

export default createStore({
  state() {
    return {
      counter: 0,
      name: "zql",
      age: 18,
      height: 1.8,
      books: [
        { name: "æ·±å…¥Vuejs", price: 200, count: 3 },
        { name: "æ·±å…¥Webpack", price: 240, count: 5 },
        { name: "æ·±å…¥React", price: 130, count: 1 },
        { name: "æ·±å…¥Nodejs", price: 200, count: 2 },
      ],
      discount: 1,
    }
  },
  //3. ç±»ä¼¼äºä¹‹å‰ç»„ä»¶ä¸­çš„è®¡ç®—å±æ€§
  getters: {
    // 6. é‚£ä¹ˆè¿™é‡Œå°±éœ€è¦ä¼ å…¥ç¬¬äºŒä¸ªå‚æ•°äº†
    totalPrice(state, getters) {
      let totalPrice = 0
      for (const book of state.books) {
        totalPrice += book.count * book.price
      }
      //7. è·å–æŠ˜æ‰£çš„æ–¹æ³•
      return totalPrice * getters.currentDiscount
    },
    //5. å¦‚æœè¿™é‡Œè¦æ˜¯æœ‰æ‰“æŠ˜çš„æ–¹æ³•çš„è¯
    currentDiscount(state) {
      return state.discount * 0.9
    },
    //8.è·å–æ•°é‡å¤§äºNçš„ï¼ŒNæ˜¯å‚æ•°ï¼Œè¿™ä¸ªæ–¹æ³•å¤§äºnçš„æ—¶å€™æ‰ä¼šå¯¹ä»·æ ¼è¿›è¡Œä¸€ä¸ªè®¡ç®—
    // å› ä¸ºè¿™é‡Œè¿˜æ˜¯åœ¨ getters é‡Œé¢çš„å‡½æ•°ï¼Œæ‰€ä»¥è¿™é‡Œçš„å‚æ•°è¿˜æ˜¯ state å’Œ getters
    // å¦‚æœæˆ‘ä»¬è‡ªå·±ä¼ å…¥å‚æ•°çš„è¯ï¼Œé‚£ä¹ˆè¿™é‡Œå°±éœ€è¦è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œå‚æ•°ä¼ å…¥å…¶ä¸­
    totalPriceCounterGreaterN(state, getters) {
      let totalPriceCounter = 0
      return function (n) {
        for (const book of state.books) {
          // 9. å¦‚æœä¼ å…¥çš„å¤§äºnæ‰ä¼šè¿›è¡Œè®¡ç®—ä»·æ ¼
          if (book.count > n) {
            totalPriceCounter += book.count * book.price
          }
        }
        return totalPriceCounter
      }
    },
    //9. nameInfo
    nameInfo(state) {
      return `name:${state.name}`
    },
    ageInfo(state) {
      return `age:${state.age}`
    },
    heightInfo(state) {
      return `height:${state.height}`
    },
  },
  mutations: {
    increment(store) {
      store.counter++
    },
    decrement(store) {
      store.counter--
    },
  },
  actions: {},
  modules: {},
})
```

10. åœ¨ç»„ä»¶ä¸­ä½¿ç”¨

![image-20230111161258965](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111161258965.png)

### ğŸ‰ åœ¨ computed ä¸­ä½¿ç”¨ mapGetters è¾…åŠ©å‡½æ•°

1. ä¸ºäº†é¿å…ä»£ç å†—ä½™ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å€ŸåŠ© mapGetters è¾…åŠ©å‡½æ•°ï¼ŒmapGetters ä¸­å¯ä»¥ç”¨æ•°ç»„å†™æ³•å’Œå¯¹è±¡å†™æ³•

![image-20230111161829236](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111161829236.png)

### ğŸ‰ åœ¨ setup ä¸­ä½¿ç”¨ mapGetters è¾…åŠ©å‡½æ•°

1. æ­£å¸¸æƒ…å†µä¸‹åœ¨ setup ä¸­ä½¿ç”¨ mapGetters

![image-20230111162328846](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111162328846.png)

2. ä½†æ˜¯å½“æˆ‘ä»¬å±æ€§è¿‡å¤šçš„æ—¶å€™ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦å†™å¤§é‡ä¸‹é¢çš„ä»£ç 

```js
const sNameInfo = computed(() => store.getters.nameInfo)
const sAgeInfo = computed(() => store.getters.ageInfo)
const sHeightInfo = computed(() => store.getters.heightInfo)
```

3. é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ç±»ä¼¼äº mapState çš„ä»£ç å°è£…ï¼Œå°è£…ä¸€ä¸ª mapGetters

![image-20230111165726111](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111165726111.png)

4. åœ¨ç»„ä»¶ä¸­ä½¿ç”¨å°è£…å¥½çš„ hooks useGetters

![image-20230111163459006](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111163459006.png)

### ğŸ‰ å¯¹ mapGetters å’Œ mapState è¿›è¡Œå°è£…

1. åˆ›å»ºä¸€ä¸ª useMapper.js çš„ hooks å¯¹ mapGetters å’Œ mapState è¿›è¡Œå°è£…

![image-20230111165952504](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111165952504.png)

2. é‚£ä¹ˆ mapGetters å’Œ mapState å°±å˜æˆäº†å¦‚ä¸‹

![image-20230111170102338](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111170102338.png)

![image-20230111170126770](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111170126770.png)

## ğŸŠVuex ç¬¬ä¸‰å¤§æ ¸å¿ƒ Mutations

1. åœ¨ store ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡æäº¤ Mutations æ¥ä¿®æ”¹æ•°æ®

### ğŸ‰ åœ¨ Mutations çš„æ–¹æ³•ä¸­æˆ‘ä»¬å¯ä»¥ä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼Œstore å’Œ payload

![image-20230111192012384](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111192012384.png)

2. å®ç°åŠŸèƒ½è‡ªå®šä¹‰åŠ  N çš„æŒ‰é’®æ“ä½œï¼Œæˆ‘ä»¬å°±éœ€è¦åœ¨æäº¤ Mutations çš„æ—¶å€™ä¼ å…¥å‚æ•°ï¼Œç„¶ååœ¨ Mutations ä¸­ï¼Œä½¿ç”¨ payload å‚æ•°æ¥æ¥æ”¶ï¼Œä¼ å…¥çš„å€¼
3. ç»„ä»¶ä¸­æäº¤ Mutations

![image-20230111182941640](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111182941640.png)

4. åœ¨ store çš„ Mutations ä¸­ï¼Œä½¿ç”¨ payload å‚æ•°æ¥æ¥æ”¶ä¼ å…¥çš„å€¼

![image-20230111183021977](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111183021977.png)

#### ğŸ¥payload ä¼ å…¥çš„å‚æ•°æ˜¯å¯¹è±¡ï¼ˆä½¿ç”¨æœ€å¤šï¼‰

![image-20230111184838929](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111184838929.png)

![image-20230111184930104](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111184930104.png)

5. ç»“æœå¦‚ä¸‹

![Mutationsç¬¬äºŒä¸ªå‚æ•°æ˜¯å¯¹è±¡å½¢å¼](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/Mutationsç¬¬äºŒä¸ªå‚æ•°æ˜¯å¯¹è±¡å½¢å¼.gif)

### ğŸ‰ é¢å¤–è¡¥å…… Mutations å¸¸é‡ç±»å‹

1. åœ¨å¼€å‘ä¸­ï¼Œå¦‚æœæ‹…å¿ƒä¸‹é¢è¿™ä¸ªä¸¤ä¸ªåç§°å†™é”™çš„è¯ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨å¸¸é‡çš„å½¢å¼ä¿å­˜è¿™ä¸ªå˜é‡åç§°

![image-20230111190630843](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111190630843.png)

2. åœ¨ store æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ª mutation-types.js æ–‡ä»¶ï¼Œç”¨äºå­˜æ”¾ Mutations ä¸­çš„ç±»å‹

![image-20230111191121033](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111191121033.png)

3. é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å¯¹ç»„ä»¶å’Œ store ä¸­çš„å˜é‡åå­—è¿›è¡Œæ›¿æ¢

![image-20230111191602899](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111191602899.png)

![image-20230111191700434](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111191700434.png)

### ğŸ‰ mapMutations è¾…åŠ©å‡½æ•°

![image-20230111193039784](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111193039784.png)

1. åªéœ€è¦åœ¨ç»„ä»¶ä¸­ä½¿ç”¨æ˜ å°„è¾…åŠ©å‡½æ•° mapMutations

![image-20230111194108993](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111194108993.png)

2. ç»„ä»¶ä¸­ä½¿ç”¨ mapMutations å¯¹ Mutations é‡Œé¢çš„æ–¹æ³•è¿›è¡Œæ˜ å°„ï¼Œç„¶åå¯ä»¥ç›´æ¥è¿›è¡Œè°ƒç”¨

![image-20230111194223773](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111194223773.png)

3. åœ¨ setup ä¸­ä½¿ç”¨ mapMutations è¿›è¡Œæ˜ å°„ï¼Œå› ä¸º mapMutations è¿”å›çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé‡Œé¢ä¹Ÿæ˜¯å‡½æ•°çš„å½¢å¼ï¼Œæ‰€ä»¥ä¸ç”¨å¯¹å…¶è¿›è¡Œå¤„ç†

![image-20230111195158745](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230111195158745.png)

## ğŸŠVuex ç¬¬å››å¤§æ ¸å¿ƒ actions

![image-20230112101239743](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112101239743.png)

1. åœ¨ç»„ä»¶ä¸­ï¼Œå¦‚æœæœ‰ä¸€äº›æ“ä½œéœ€è¦æäº¤ Mutations æ¥æ“ä½œæ•°æ®ï¼Œä½†å¦‚æœæœ‰å¼‚æ­¥æ“ä½œçš„è¯ï¼Œæ¯”å¦‚ç½‘ç»œè¯·æ±‚æˆ‘ä»¬æœ‰ä¸¤ç§æ–¹æ³•
   - ç¬¬ä¸€ç§æˆ‘ä»¬å¯ä»¥ï¼Œåœ¨ç»„ä»¶ä¸­çš„ onMounted æˆ–è€…æ˜¯ setup() ä¸­æ‹¿åˆ°æ•°æ®ï¼Œå†æœ‰ç»„ä»¶é€šè¿‡ Mutations æäº¤æ“ä½œï¼Œç„¶åå°†æ•°æ®å­˜å‚¨åœ¨ state ä¸­
   - å¦‚æœè¯·æ±‚ä¸‹æ¥çš„æ•°æ®ï¼Œä¸å¸Œæœ›ç”±ç»„ä»¶æ¥ç®¡ç†ï¼Œç›´æ¥æäº¤åˆ° State ä¸Šï¼Œé‚£å°†è¯·æ±‚æ”¾åœ¨ç»„ä»¶ä¸­å°±ä¸å¤ªåˆé€‚ï¼Œå¹¶ä¸” Mutations ä¸­ä¸å…è®¸æœ‰å¼‚æ­¥æ“ä½œï¼Œåªèƒ½æœ‰åŒæ­¥ä»£ç ã€‚é‚£ä¹ˆæˆ‘ä»¬ç½‘ç»œè¯·æ±‚è¦æƒ³æ”¾åœ¨ Vuex ä¸­çš„è¯ï¼Œåªèƒ½æ”¾åœ¨ Actions é‡Œé¢ï¼Œåœ¨ Actions é‡Œé¢é€šè¿‡ commit æäº¤ Mutations æ¥ä¿®æ”¹æ•°æ®

#### ğŸ‰Actions ä½¿ç”¨ç¤ºä¾‹

1. åœ¨ç»„ä»¶ä¸­åˆ†å‘ Actions

![image-20230112112647248](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112112647248.png)

2. åœ¨ Vuex ä¸­å†™ä¸€ä¸ª Actions ç”¨äºå­˜æ”¾å‡½æ•°

![image-20230112112925819](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112112925819.png)

#### ğŸ‰Actions é‡Œé¢å¯ä»¥å­˜æ”¾å¼‚æ­¥æ“ä½œ

1. åœ¨ç»„ä»¶ä¸­åˆ†å‘ Actions

![image-20230112112647248](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112112647248.png)

2. åœ¨ Actions é‡Œé¢è®¾ç½®å¼‚æ­¥æ“ä½œï¼Œæ„å‘³ç€æäº¤ Mutations é‡Œé¢å°±æœ‰äº†å»¶è¿Ÿ

![image-20230112113306515](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112113306515.png)

#### ğŸ‰ ç½‘ç»œè¯·æ±‚çš„ä¸¤ç§æ–¹å¼

##### ğŸ¥ ç¬¬ä¸€ç§æ–¹å¼æäº¤ Mutations

1. ç¬¬ä¸€ç§æˆ‘ä»¬å¯ä»¥ï¼Œåœ¨ç»„ä»¶ä¸­çš„ onMounted æˆ–è€…æ˜¯ setup() ä¸­æ‹¿åˆ°æ•°æ®ï¼Œå†æœ‰ç»„ä»¶é€šè¿‡ Mutations æäº¤æ“ä½œï¼Œç„¶åå°†æ•°æ®å­˜å‚¨åœ¨ state ä¸­

![image-20230112114553762](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112114553762.png)

2. åœ¨ Mutations ä¸­æ¥æ”¶ç»„ä»¶ä¸­ä¼ å…¥çš„æ•°æ®ï¼Œå¹¶ä¸”å­˜å…¥åˆ° State ä¸­

![image-20230112114850245](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112114850245.png)

##### ğŸ¥ ç¬¬äºŒç§æ–¹å¼ Actions

![image-20230112134551448](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112134551448.png)

1. å¦‚æœè¯·æ±‚ä¸‹æ¥çš„æ•°æ®ï¼Œä¸å¸Œæœ›ç”±ç»„ä»¶æ¥ç®¡ç†ï¼Œç›´æ¥æäº¤åˆ° State ä¸Šï¼Œé‚£å°†è¯·æ±‚æ”¾åœ¨ç»„ä»¶ä¸­å°±ä¸å¤ªåˆé€‚ï¼Œå¹¶ä¸” Mutations ä¸­ä¸å…è®¸æœ‰å¼‚æ­¥æ“ä½œï¼Œåªèƒ½æœ‰åŒæ­¥ä»£ç ã€‚é‚£ä¹ˆæˆ‘ä»¬ç½‘ç»œè¯·æ±‚è¦æƒ³æ”¾åœ¨ Vuex ä¸­çš„è¯ï¼Œåªèƒ½æ”¾åœ¨ Actions é‡Œé¢ï¼Œåœ¨ Actions é‡Œé¢é€šè¿‡ commit æäº¤ Mutations æ¥ä¿®æ”¹æ•°æ®
2. åœ¨ç»„ä»¶ä¸­åˆ†å‘ Actions

![image-20230112115615447](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112115615447.png)

3. åœ¨ Vuex çš„ Actions é‡Œé¢è¿›è¡Œå¼‚æ­¥è¯·æ±‚æ•°æ®çš„æ“ä½œ

![image-20230112120243733](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112120243733.png)

#### ğŸ‰Actions çš„ä¸¤ä¸ªå‚æ•°

##### ğŸ¥Actions ç¬¬ä¸€ä¸ªå‚æ•° context è¯¦ç»†è§£è¯»

![image-20230112121413008](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112121413008.png)

![image-20230112125603483](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112125603483.png)

##### ğŸ¥ åˆ†å‘ Actions ç¬¬äºŒä¸ªå‚æ•°å¯ä»¥æºå¸¦å‚æ•°

1. åœ¨ç»„ä»¶ä¸­åˆ†å‘ Actions çš„æ—¶å€™ï¼Œå¯ä»¥æºå¸¦æ•°æ®

![image-20230112120808457](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112120808457.png)

2. åœ¨ Actions é‡Œé¢ï¼Œç¬¬äºŒä¸ªå‚æ•°å°±æ˜¯ç»„ä»¶ä¸­ä¼ å…¥çš„æ•°æ®

![image-20230112121014283](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112121014283.png)

#### ğŸ‰Actions çš„è¾…åŠ©å‡½æ•° mapActions

![image-20230112134709885](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112134709885.png)

##### ğŸ¥ åœ¨ OptionsApi_mapActions é‡Œé¢çš„å†™æ³•(åœ¨ methods é‡Œé¢)

![image-20230112131035539](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112131035539.png)

![image-20230112131707330](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112131707330.png)

##### ğŸ¥ åœ¨ CompositionApi_mapActions é‡Œé¢çš„å†™æ³•(åœ¨ setup é‡Œé¢)

![image-20230112131612136](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112131612136.png)

![image-20230112131710564](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112131710564.png)

#### ğŸ‰ ç½‘ç»œè¯·æ±‚ Vuex_actions è¿”å› Promise

![image-20230112134430291](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112134430291.png)

- å¦‚æœæˆ‘ä»¬åœ¨ç½‘ç»œè¯·æ±‚ä¸­ä½¿ç”¨äº†å¦‚ä¸‹çš„ä»£ç ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªèƒ½åœ¨ Vuex ä¸­å¾—åˆ°ç½‘ç»œè¯·æ±‚ä»€ä¹ˆæ—¶å€™æˆåŠŸ

![image-20230112133249518](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112133249518.png)

![image-20230112133429878](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112133429878.png)

- ä½†æˆ‘ä»¬æƒ³è¦åœ¨ç»„ä»¶ä¸­å¾—çŸ¥ç½‘ç»œè¯·æ±‚ä½•æ—¶æˆåŠŸæˆ–è€…å¤±è´¥çš„è¯ï¼Œå°±å¯ä»¥åœ¨ Actions ä¸­è¿”å›ä¸€ä¸ª Promise ç»™ç»„ä»¶ï¼Œé‚£ä¹ˆå°±å¯ä»¥åœ¨ Vuex_actions ä¸­è¿”å› Promise

![image-20230112133756951](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112133756951.png)

![image-20230112134046105](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112134046105.png)

## ğŸŠVuex ç¬¬äº”å¤§æ ¸å¿ƒ Module

![image-20230112135916740](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112135916740.png)

- å½“é‡‡ç”¨äº† Vuex æ¥ç®¡ç†æ•°æ®ä¹‹åï¼Œé‚£ä¹ˆæ‰€æœ‰çš„é¡µé¢æ¯”å¦‚ Home User Cart Goods é‡Œé¢çš„æ•°æ®éƒ½å­˜å‚¨åˆ°äº† Vuex ä¸­ï¼Œæ¯ä¸ªé¡µé¢éƒ½æœ‰è‡ªå·±å¾ˆå¤šçš„æ•°æ®ï¼Œé‚£ä¹ˆè¿™ä¸ª Vuex é‡Œé¢çš„å†…å®¹å°±è¶Šæ¥è¶Šå¤šï¼Œæœ€ç»ˆç®¡ç† Vuex é‡Œé¢çš„æ“ä½œå°±éå¸¸çš„ç¹ç

- é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é‡‡ç”¨åˆ†æ¨¡å—ï¼Œå°† Home User Cart Goods éƒ½æ”¾åœ¨è‡ªå·±çš„æ¨¡å—ä¸­ï¼Œæ¯ä¸ªæ¨¡å—éƒ½æœ‰è‡ªå·±çš„ Getters State Mutations Actions Modules

#### ğŸ‰ åˆ†æ¨¡å—å¤„ç†

1. åœ¨ store æ–‡ä»¶å¤¹ä¸‹åˆ›å»º modules æ–‡ä»¶å¤¹å­˜æ”¾åˆ†æ¨¡å—çš„å†…å®¹

![image-20230112141009483](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112141009483.png)

![image-20230112141126695](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112141126695.png)

2. åœ¨ Vuex ä¸­å¯¼å…¥åˆ†æ¨¡å—çš„å†…å®¹

![image-20230112141452971](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112141452971.png)

3. åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ home user åˆ†æ¨¡å—åçš„æ•°æ®

![image-20230112141740301](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112141740301.png)

4. é¡µé¢æ•ˆæœ

![image-20230112141809270](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112141809270.png)

#### ğŸ‰module çš„å±€éƒ¨çŠ¶æ€

##### ğŸ¥mutation ä¸­é‡åˆ°çš„é—®é¢˜

1. å½“ Vuex ä¸­çš„ root çš„ Mutation ä¸­æœ‰ä¸€ä¸ªæ–¹æ³•åå«åš incrementï¼Œå¹¶ä¸”åˆ†æ¨¡å— home çš„ Mutation ä¸­ä¹Ÿæœ‰ä¸€ä¸ªæ–¹æ³•åå«åš incrementï¼Œå½“ç‚¹å‡»äº‹ä»¶çš„æ—¶å€™åœ¨ methods ä¸­é€šè¿‡ `this.$store.commit("increment")` çš„æ—¶å€™ï¼Œé‚£ä¹ˆä¸¤ä¸ªæ•°æ®éƒ½ä¼šè¢«æ›´æ”¹

2. home æ¨¡å—

![image-20230112143232913](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112143232913.png)

3. root æ ¹æ¨¡å—

![image-20230112143314445](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112143314445.png)

4. ç»„ä»¶ä¸­æäº¤ Mutation

![image-20230112143354634](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112143354634.png)

5. é¡µé¢ç»“æœ

![moduleçš„å±€éƒ¨çŠ¶æ€](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/moduleçš„å±€éƒ¨çŠ¶æ€.gif)

6. å¦‚ä½•è§£å†³ï¼šåœ¨ action é‡Œé¢é€šè¿‡ commit æäº¤ä¸€ä¸ª mutation

![image-20230112150210845](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112150210845.png)

7. å¦‚ä½•åœ¨ç»„ä»¶ä¸­æ´¾å‘åˆšæ‰çš„ action å‘¢ï¼Ÿ

![image-20230112151119498](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112151119498.png)

8. ç›´æ¥é€šè¿‡ `this.$store.dispatch("incrementAction");` æ´¾å‘å³å¯

##### ğŸ¥getters ä¸­é‡åˆ°çš„é—®é¢˜

1. home æ¨¡å—

![image-20230112143952807](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112143952807.png)

2. ç»„ä»¶ä¸­ä½¿ç”¨ home ç»„ä»¶ä¸­çš„ getters

![image-20230112144052681](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112144052681.png)

3. é¡µé¢æ˜¾ç¤ºç»“æœ

![image-20230112144258770](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112144258770.png)

4. åŸå› å°±æ˜¯å½“æˆ‘ä»¬é€šè¿‡ `$store.state.home` çš„æ–¹å¼æ‹¿æ•°æ®çš„æ—¶å€™åªèƒ½æ‹¿åˆ°çš„æ˜¯æ¨¡å— state ä¸­çš„æ•°æ®

![image-20230112144807014](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112144807014.png)

5. é‚£æ€ä¹ˆè·å–åˆ° home æ¨¡å—ä¸­çš„ getters å‘¢ï¼Ÿ
   - å½“åˆ†å‡ºæ¥çš„æ¨¡å—ä¸­å«æœ‰ getters çš„æ—¶å€™ï¼Œæ˜¯ä¸ root æ¨¡å—ä¸­çš„ getters è¿›è¡Œäº†åˆå¹¶ï¼Œç›´æ¥åœ¨ `$store.getters.doubleHomeCounter` ä¸­è·å–å³å¯

![image-20230112145153808](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112145153808.png)

6. é¡µé¢æ•ˆæœ

![image-20230112145246845](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112145246845.png)

##### ğŸ¥ æ€»ç»“ä¸Šé¢ä¸¤ä¸ªé—®é¢˜

- ä¸Šé¢çš„åŠæ³•ç›´æ¥é€šè¿‡ `this.$store.dispatch("incrementAction");` æ´¾å‘ home æ¨¡å—ä¸­çš„ Action å’Œç›´æ¥é€šè¿‡ `$store.getters.doubleHomeCounter` è·å– home æ¨¡å—ä¸­çš„æ•°æ®

- ç¼ºç‚¹å°±æ˜¯è¿™æ ·çš„æ–¹å¼æ²¡æœ‰åŠæ³•åŒºåˆ†æ˜¯åˆ†æ¨¡å—ä¸­çš„ action å’Œ doubleHomeCounter æ•°æ®ï¼Œè¿˜æ˜¯æ ¹æ¨¡å—ä¸­çš„ action å’Œ doubleHomeCounter æ•°æ®

#### ğŸ‰module çš„å‘½åç©ºé—´

![image-20230112160739100](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112160739100.png)

##### ğŸ¥ é‚£ä¹ˆè¯¥æ€ä¹ˆåŒºåˆ†æ˜¯åˆ†æ¨¡å—ä¸­çš„æ•°æ®å’Œ Actionï¼Œè¿˜æ˜¯æ ¹æ¨¡å—ä¸­çš„æ•°æ®å’Œ Action å‘¢ï¼Ÿ

1. å¯ä»¥åœ¨åˆ†æ¨¡å—ä¸­è®¾ç½® namespaced ä¸º trueï¼Œè®¾ç½®ç‹¬ç«‹çš„å‘½åç©ºé—´

![image-20230112151944216](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112151944216.png)

2. è®¾ç½®ä¹‹ååœ¨ç»„ä»¶ä¸­è·å–æ¨¡å—ç‹¬ç«‹ç©ºé—´æ•°æ®çš„æ–¹å¼

![image-20230112152618980](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112152618980.png)

3. é¡µé¢æ˜¾ç¤ºç»“æœ

![image-20230112152105084](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112152105084.png)

![è®¾ç½®namespacedä¹‹åçš„é¡µé¢ç»“æœ](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/è®¾ç½®namespacedä¹‹åçš„é¡µé¢ç»“æœ.gif)

4. ä¸Šé¢çš„æäº¤ Mutation å·²ç»è§£å†³äº†ï¼Œä½†æ˜¯å½“æˆ‘ä»¬åˆ†å‘ Action çš„æ—¶å€™å°±ä¼šå‡ºé”™

![image-20230112153218196](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112153218196.png)

5. å› ä¸º dispatch åˆ†å‘ action çš„æ—¶å€™åªä¼š dispatch root é‡Œé¢çš„ action

![image-20230112153511979](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112153511979.png)

6. å› ä¸º dispatch åˆ†å‘çš„æ˜¯ home æ¨¡å— ä¸‹é¢çš„ incrementActionï¼Œæ‰€ä»¥éœ€è¦åœ¨ dispatch çš„æ—¶å€™æŒ‡å®š `home/incrementAction`

![image-20230112153907341](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112153907341.png)

7. é¡µé¢ç»“æœ

![è®¾ç½®namespacedä¹‹åçš„é¡µé¢ç»“æœ2.gif](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/è®¾ç½®namespacedä¹‹åçš„é¡µé¢ç»“æœ2.gif)

##### ğŸ¥actions å’Œ getters é‡Œé¢å‚æ•°çš„é¢å¤–è¡¥å……

1. åœ¨ home æ¨¡å—ä¸­ä½¿ç”¨å‚æ•°

![image-20230112155733668](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112155733668.png)

2. åœ¨ç»„ä»¶ä¸­ä½¿ç”¨åˆ° home æ¨¡å—ä¸­çš„ getters è·å–çš„æ•°æ®å’Œ actions æäº¤çš„ Mutation

![image-20230112160159281](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112160159281.png)

3. é¡µé¢ç»“æœ

![ä½¿ç”¨getterså’Œactioné‡Œé¢çš„å‚æ•°é¡µé¢ç»“æœ](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/ä½¿ç”¨getterså’Œactioné‡Œé¢çš„å‚æ•°é¡µé¢ç»“æœ.gif)

#### ğŸ‰module çš„è¾…åŠ©å‡½æ•°

##### ğŸ¥OptionsApi_mapModule

1. åˆ†æ¨¡å— home æ¨¡å—ä¸­çš„å†…å®¹

![image-20230112161927482](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112161927482.png)

2. å¦‚æœæˆ‘ä»¬ç›´æ¥ç”¨è¿™äº›è¾…åŠ©å‡½æ•°ï¼Œé‚£ä¹ˆé¡µé¢ä¸­æ˜¯æ²¡æœ‰ä»»ä½•æ˜¾ç¤ºçš„ã€‚å› ä¸ºè¿™æ ·ä½¿ç”¨çš„å‰ææ˜¯åœ¨æ ¹ç»„ä»¶ä¸­æœ‰è¿™äº›ä¸œè¥¿ï¼Œè€Œè¿™äº›å†…å®¹ä»…ä»…æ˜¯å­˜åœ¨äºç‹¬ç«‹å‘½åç©ºé—´çš„ home æ¨¡å—ä¸­ï¼Œæ‰€ä»¥æ— æ³•ä½¿ç”¨

![image-20230112161935968](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112161935968.png)

3. é¡µé¢ç»“æœ

![image-20230112162010023](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112162010023.png)

4. å¦‚ä½•è§£å†³ï¼Œåˆ†æ¨¡å— home æ¨¡å—ä¸­çš„å†…å®¹

![image-20230112161927482](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112161927482.png)

5. æˆ‘ä»¬åªéœ€è¦åœ¨ç»„ä»¶ä¸­æŒ‡å®šæ¨¡å—å³å¯

![image-20230112163417562](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112163417562.png)

6. mapModule çš„ç¬¬ä¸‰ç§å†™æ³•

![image-20230112164606540](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112164606540.png)

7. é¡µé¢ç»“æœå¦‚ä¸‹

![ä½¿ç”¨moduleè¾…åŠ©å‡½æ•°ä¹‹åçš„ç»“æœ.gif](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/ä½¿ç”¨moduleè¾…åŠ©å‡½æ•°ä¹‹åçš„ç»“æœ.gif)

##### ğŸ¥CompositionApi_mapModule

1. åˆ†æ¨¡å— home æ¨¡å—ä¸­çš„å†…å®¹

![image-20230112161927482](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112161927482.png)

2. åœ¨ setup ä¸­ä½¿ç”¨ mapModule å¦‚æœç›´æ¥ä½¿ç”¨å°±ä¼šå‡ºç°é—®é¢˜

![image-20230112170419485](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112170419485.png)

3. é¡µé¢æ˜¾ç¤ºç»“æœ

![image-20230112170503340](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112170503340.png)

###### ğŸ å¦‚ä½•è§£å†³ï¼Ÿå¯ä»¥å°†ä¹‹å‰å°è£…çš„ useState å’Œ useGetters æ‹¿è¿‡æ¥ä½¿ç”¨

```js
// ä½†æ˜¯ä¼šå‡ºç°ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å°è£…çš„æ—¶å€™æ²¡æœ‰è€ƒè™‘åˆ°åˆ†æ¨¡å—çš„éƒ¨åˆ†
// æ‰€ä»¥éœ€è¦å¯¹ useState å’Œ useGetters è¿›è¡Œæ”¹å†™
```

1. ä¹‹å‰å°è£…çš„ä»£ç å¦‚ä¸‹

- äºŒæ¬¡å°è£…ä»£ç 

```js
// 08_learn_vuex\src\hooks\useMapper.js
// æˆ‘ä»¬å‘ç°åœ¨ useGetters å’Œ useState ä¸­æœ‰å¤§é‡çš„ä»£ç é‡å¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å¯¹å…¶è¿›è¡Œå°è£…
import { computed } from "vue"
import { mapGetters, useStore } from "vuex"
// æˆ‘ä»¬è¿™é‡Œå¯ä»¥ä¼ å…¥ç¬¬äºŒä¸ªå‚æ•° mapFn æ¥ç¡®å®šä¼ å…¥çš„æ˜¯ mapGetters è¿˜æ˜¯ mapState
export function useMapper(mapper, mapFn) {
  //  æ‹¿åˆ°storeå¯¹è±¡
  const store = useStore()
  // å”¯ä¸€çš„ä¸åŒå°±æ˜¯è¿™é‡Œåé¢çš„æ•°æ®ä¸å¯ä»¥å†™æ­»ã€‚è¿™é‡Œéœ€è¦æ¥æ”¶å‚æ•°
  // è·å–åˆ°å¯¹åº”çš„å¯¹è±¡çš„ functions:{name:function,age:function}
  const storeStateFns = mapFn(mapper)
  // å¯¹æ•°æ®è¿›è¡Œè½¬æ¢ï¼Œå°†å‡½æ•°è½¬æ¢æˆéœ€è¦çš„ ref å¯¹è±¡ï¼Œå¯¹å…¶è¿›è¡Œä½¿ç”¨
  const storeState = {}
  Object.keys(storeStateFns).forEach((fnKey) => {
    const fn = storeStateFns[fnKey].bind({ $store: store }) //3.9 è¿™é‡Œæ˜¯æ²¡æœ‰thisçš„ =>undefined.$storeï¼Œé€šè¿‡bindç»‘å®šthis
    storeState[fnKey] = computed(fn)
  })
  return storeState
}
```

- useState.js

```js
// 08_learn_vuex\src\hooks\useState.js
/**
 * åœ¨ setup ä¸­ä½¿ç”¨ mapState å°†å‡½æ•°è½¬æ¢æˆ ref å¯¹è±¡
 */
import { mapState } from "vuex"
import { useMapper } from "./useMapper"
export function useState(mapper) {
  return useMapper(mapper, mapState)
}
```

- useGetters.js

```js
// 08_learn_vuex\src\hooks\useState.js
/**
 * åœ¨setupä¸­ä½¿ç”¨ mapState å°†å‡½æ•°è½¬æ¢æˆ ref å¯¹è±¡
 */
import { mapGetters } from "vuex"
import { useMapper } from "./useMapper"
export function useGetters(mapper) {
  return useMapper(mapper, mapGetters)
}
```

2. å¯¹å°è£…çš„æ–¹æ³•è¿›è¡Œæ”¹å†™

- äºŒæ¬¡å°è£…ä»£ç 

```js
// 08_learn_vuex\src\hooks\useMapper.js
// æˆ‘ä»¬å‘ç°åœ¨ useGetters å’Œ useState ä¸­æœ‰å¤§é‡çš„ä»£ç é‡å¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å¯¹å…¶è¿›è¡Œå°è£…
import { computed } from "vue"
import { mapGetters, useStore } from "vuex"
// æˆ‘ä»¬è¿™é‡Œå¯ä»¥ä¼ å…¥ç¬¬äºŒä¸ªå‚æ•° mapFn æ¥ç¡®å®šä¼ å…¥çš„æ˜¯ mapGetters è¿˜æ˜¯ mapState
export function useMapper(mapper, mapFn) {
  //  æ‹¿åˆ°storeå¯¹è±¡
  const store = useStore()
  // å”¯ä¸€çš„ä¸åŒå°±æ˜¯è¿™é‡Œåé¢çš„æ•°æ®ä¸å¯ä»¥å†™æ­»ã€‚è¿™é‡Œéœ€è¦æ¥æ”¶å‚æ•°
  // è·å–åˆ°å¯¹åº”çš„å¯¹è±¡çš„ functions:{name:function,age:function}
  const storeStateFns = mapFn(mapper)
  // å¯¹æ•°æ®è¿›è¡Œè½¬æ¢ï¼Œå°†å‡½æ•°è½¬æ¢æˆéœ€è¦çš„ ref å¯¹è±¡ï¼Œå¯¹å…¶è¿›è¡Œä½¿ç”¨
  const storeState = {}
  Object.keys(storeStateFns).forEach((fnKey) => {
    const fn = storeStateFns[fnKey].bind({ $store: store }) //3.9 è¿™é‡Œæ˜¯æ²¡æœ‰thisçš„ =>undefined.$storeï¼Œé€šè¿‡bindç»‘å®šthis
    storeState[fnKey] = computed(fn)
  })
  return storeState
}
```

- useState.js

```js
// createNamespacedHelpers è¿”å›çš„æ˜¯ä¸€ä¸ªå¯¹è±¡æ‰€ä»¥éœ€è¦ä½¿ç”¨ createNamespacedHelpers("home").mapGetters
// createNamespacedHelpers("home").mapState è·å–åˆ° mapGetters å’Œ mapState
```

```js
// 08_learn_vuex\src\hooks\useState.js
/**
 * åœ¨ setup ä¸­ä½¿ç”¨ mapState å°†å‡½æ•°è½¬æ¢æˆ ref å¯¹è±¡
 */
import { mapState, createNamespacedHelpers } from "vuex"
import { useMapper } from "./useMapper"
// ä¼ è¿›æ¥ moduleName æ¥åˆ¤æ–­æ˜¯å“ªä¸ªæ¨¡å—
export function useState(moduleName, mapper) {
  // 2.1 æœªåˆ†æ¨¡å—
  let mapperFn = mapState
  //1.1. å¯¹ moduleName è¿›è¡Œå¤„ç†ï¼Œæ¯”å¦‚ä¼ å…¥çš„æ˜¯ useState("",[])çš„è¯ï¼Œä¹Ÿæ˜¯ä¸ä¼šä½¿ç”¨ç›´æ¥å» root æ¨¡å—ä¸­æ“ä½œ
  // .mapState æ˜¯åœ¨å¯¹è±¡é‡Œé¢ä¸­å–åˆ° mapState
  if (typeof moduleName === "string" && moduleName.length > 0) {
    mapperFn = createNamespacedHelpers(moduleName).mapState
  }
  // è¿™é‡Œçš„ mapState æ˜¯ä¸ç¡®å®šæ€ä¹ˆå†™çš„
  // 1. ç¬¬ä¸€ç§ å¦‚æœä¼ å…¥çš„æ˜¯ useState("home",[])çš„è¯ï¼Œè¯´æ˜æ˜¯åˆ†æ¨¡å—äº†ï¼Œå°±éœ€è¦ä½¿ç”¨ createNamespacedHelpers å–åˆ°å¯¹åº”çš„æ¨¡å—åå­—ï¼Œåˆ›å»ºå‡ºæ¥å¯¹åº”çš„æ˜ å°„å‡½æ•°ï¼Œåœ¨ä¼ å…¥ useMapper ä¸­
  // 2. ç¬¬äºŒç§ å¦‚æœä¼ å…¥çš„æ˜¯ useState([]) çš„è¯ï¼Œè¯´æ˜æ˜¯æ²¡æœ‰åˆ†æ¨¡å—çš„ï¼Œç›´æ¥ä½¿ç”¨ mapState å³å¯
  // æ‰€ä»¥è¿™é‡Œä¸èƒ½å†™æˆ mapState
  // return useMapper(mapper, mapState)
  return useMapper(mapper, mapperFn)
}
```

- useGetter.js

```js
// 08_learn_vuex\src\hooks\useState.js
/**
 * åœ¨setupä¸­ä½¿ç”¨ mapState å°†å‡½æ•°è½¬æ¢æˆ ref å¯¹è±¡
 */
import { mapGetters, createNamespacedHelpers } from "vuex"
import { useMapper } from "./useMapper"
export function useGetters(moduleName, mapper) {
  let mapperFn = mapGetters
  if (typeof moduleName === "string" && moduleName.length > 0) {
    // .mapGetters æ˜¯åœ¨å¯¹è±¡é‡Œé¢ä¸­å–åˆ° mapGetters
    mapperFn = createNamespacedHelpers(moduleName).mapGetters
  }
  return useMapper(mapper, mapperFn)
}
```

3. è¿™æ ·å†™ä¹‹åå°±éœ€è¦åœ¨ç»„ä»¶ä¸­å†™çš„æ—¶å€™éœ€è¦å¸¦ä¸Šæ˜¯å“ªä¸ªæ¨¡å—çš„å†…å®¹

```js
const state = useState("home", ["homeCounter"])
const getters = useGetters("home", ["doubleHomeCounter"])
```

![image-20230112174407431](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/image-20230112174407431.png)

4. é¡µé¢ç»“æœå¦‚ä¸‹

![useState_CompositionApi_mapModuleé¡µé¢ç»“æœ](http://www.zhangqilong.cn/img/qlBlog_images/Vue%E5%9F%BA%E7%A1%80/29_learn_vuex/useState_CompositionApi_mapModuleé¡µé¢ç»“æœ.gif)
